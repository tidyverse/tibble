<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Controlling display of numbers • tibble</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Controlling display of numbers">
<meta name="robots" content="noindex">
<script defer data-domain="tibble.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tibble</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.2.1.9032</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tibble.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/types.html">Column types</a></li>
    <li><a class="dropdown-item" href="../articles/numbers.html">Controlling display of numbers</a></li>
    <li><a class="dropdown-item" href="../articles/digits.html">Comparing display with data frames</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer</h6></li>
    <li><a class="dropdown-item" href="../articles/extending.html">Extending tibble</a></li>
    <li><a class="dropdown-item" href="../articles/invariants.html">Invariants: Comparing behavior with data frames</a></li>
    <li><a class="dropdown-item" href="../articles/formats.html">Column formats</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/04/tibble-3-0-0/">Version 3.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/03/tibble-2.1.1/">Version 2.1.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/01/tibble-2.0.1/">Version 2.0.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/11/tibble-2.0.0-pre-announce/">Version 2.0.0 pre-announcement</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/01/tibble-1-4-2/">Version 1.4.2</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/01/tibble-1-4-1/">Version 1.4.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/tibble/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Controlling display of numbers</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/tibble/blob/main/vignettes/numbers.Rmd" class="external-link"><code>vignettes/numbers.Rmd</code></a></small>
      <div class="d-none name"><code>numbers.Rmd</code></div>
    </div>

    
    
<p>Tibbles print numbers with three significant digits by default,
switching to scientific notation if the available space is too small.
Underlines are used to highlight groups of three digits. The display
differs from the default display for data frames, see
<code><a href="../articles/digits.html">vignette("digits")</a></code> for an overview over the differences.
This display works for many, but not for all use cases.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="options">Options<a class="anchor" aria-label="anchor" href="#options"></a>
</h2>
<p>The easiest way to customize the display of numbers and other data in
a tibble is to define options. See <code><a href="https://pillar.r-lib.org/reference/pillar_options.html" class="external-link">?pillar::pillar_options</a></code>
for a comprehensive overview.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">123.4567</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;       x</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  123.</span></span>
<span><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>pillar.sigfig <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">123.4567</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;          x</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 123.456<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co"># Restore old options, see also rlang::local_options() for a more elegant way</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span></span></code></pre></div>
<p>This changes the display of all columns. Read on to see how too
specify display options on a column-by-column basis.</p>
</div>
<div class="section level2">
<h2 id="per-column-number-formatting">Per-column number formatting<a class="anchor" aria-label="anchor" href="#per-column-number-formatting"></a>
</h2>
<p>The new <code><a href="../reference/num.html">num()</a></code> constructor allows creating vectors that
behave like numbers but allow customizing their display. Below a few
examples are shown, see <code><a href="../reference/num.html">?num</a></code> for a comprehensive overview.
Similarly, <code><a href="../reference/char.html">char()</a></code> allows customizing the display of
character columns.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"sci"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(sci)[5]&gt;</span></span>
<span><span class="co">#&gt; [1] -1e0  0    1e0  2e0  3e0</span></span>
<span><span class="fu"><a href="../reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x4 <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">0.5</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">0.5</span>, digits <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  usd <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">0.5</span>, digits <span class="op">=</span> <span class="fl">2</span>, label <span class="op">=</span> <span class="st">"USD"</span><span class="op">)</span>,</span>
<span>  percent <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">12</span> <span class="op">/</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">0.0005</span>, label <span class="op">=</span> <span class="st">"%"</span>, scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>  eng <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, notation <span class="op">=</span> <span class="st">"eng"</span>, fixed_exponent <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  si <span class="op">=</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">123</span>, notation <span class="op">=</span> <span class="st">"si"</span><span class="op">)</span>,</span>
<span>  char <span class="op">=</span> <span class="fu"><a href="../reference/char.html">char</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">LETTERS</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>, shorten <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 7</span></span></span>
<span><span class="co">#&gt;          x4       x1     usd percent   eng      si char                   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;num:.4!&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num:.1&gt;</span>     <span style="color: #949494; font-style: italic;">USD</span>       <span style="color: #949494; font-style: italic;">%</span> <span style="font-style: italic;">[</span><span style="color: #949494; font-style: italic;">e</span><span style="color: #BB0000; font-style: italic;">-3</span><span style="font-style: italic;">]</span>    <span style="color: #949494; font-style: italic;">&lt;si&gt;</span> <span style="color: #949494; font-style: italic;">&lt;char&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  800.500<span style="text-decoration: underline;">0</span>    800.5  800.50    8.05     1 123   m A B C D E F…U V W X Y Z</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  900.500<span style="text-decoration: underline;">0</span>    900.5  900.50    9.05    10   1.23  A B C D E F…U V W X Y Z</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="text-decoration: underline;">1</span>000.500<span style="text-decoration: underline;">0</span>   <span style="text-decoration: underline;">1</span>000.5 <span style="text-decoration: underline;">1</span>000.50   10.0    100  12.3   A B C D E F…U V W X Y Z</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="text-decoration: underline;">1</span>100.500<span style="text-decoration: underline;">0</span>   <span style="text-decoration: underline;">1</span>100.5 <span style="text-decoration: underline;">1</span>100.50   11.0   <span style="text-decoration: underline;">1</span>000 123     A B C D E F…U V W X Y Z</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="text-decoration: underline;">1</span>200.500<span style="text-decoration: underline;">0</span>   <span style="text-decoration: underline;">1</span>200.5 <span style="text-decoration: underline;">1</span>200.50   12.0  <span style="text-decoration: underline;">10</span>000   1.23k A B C D E F…U V W X Y Z</span></span></code></pre></div>
<p>The pillar package that is responsible for the display of tibbles
tries hard to get the number display right, however it is impossible to
accommodate all use cases. Whenever the default formatting does not suit
the application, <code><a href="../reference/num.html">num()</a></code> or <code><a href="../reference/char.html">char()</a></code> allow
redefining the formatting for individual columns. The formatting
survives most data transformations.</p>
</div>
<div class="section level2">
<h2 id="rule-based-number-formatting">Rule-based number formatting<a class="anchor" aria-label="anchor" href="#rule-based-number-formatting"></a>
</h2>
<p>Currently, formatting must be applied manually for each column. The
following pattern may help doing this consistently for all columns in a
tibble, or for some columns based on their name.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">markets</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">)</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">markets</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,860 × 5</span></span></span>
<span><span class="co">#&gt;     time   DAX   SMI   CAC  FTSE</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>991. <span style="text-decoration: underline;">1</span>629. <span style="text-decoration: underline;">1</span>678. <span style="text-decoration: underline;">1</span>773. <span style="text-decoration: underline;">2</span>444.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>614. <span style="text-decoration: underline;">1</span>688. <span style="text-decoration: underline;">1</span>750. <span style="text-decoration: underline;">2</span>460.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>607. <span style="text-decoration: underline;">1</span>679. <span style="text-decoration: underline;">1</span>718  <span style="text-decoration: underline;">2</span>448.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>621. <span style="text-decoration: underline;">1</span>684. <span style="text-decoration: underline;">1</span>708. <span style="text-decoration: underline;">2</span>470.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>618. <span style="text-decoration: underline;">1</span>687. <span style="text-decoration: underline;">1</span>723. <span style="text-decoration: underline;">2</span>485.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>611. <span style="text-decoration: underline;">1</span>672. <span style="text-decoration: underline;">1</span>714. <span style="text-decoration: underline;">2</span>467.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>631. <span style="text-decoration: underline;">1</span>683. <span style="text-decoration: underline;">1</span>734. <span style="text-decoration: underline;">2</span>488.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>640. <span style="text-decoration: underline;">1</span>704. <span style="text-decoration: underline;">1</span>757. <span style="text-decoration: underline;">2</span>508.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>635. <span style="text-decoration: underline;">1</span>698. <span style="text-decoration: underline;">1</span>754  <span style="text-decoration: underline;">2</span>510.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>992. <span style="text-decoration: underline;">1</span>646. <span style="text-decoration: underline;">1</span>716. <span style="text-decoration: underline;">1</span>754. <span style="text-decoration: underline;">2</span>497.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,850 more rows</span></span></span>
<span><span class="va">markets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">time</span>, <span class="op">~</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="va">.x</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,860 × 5</span></span></span>
<span><span class="co">#&gt;     time       DAX       SMI       CAC      FTSE</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num:.3!&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num:.3!&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num:.3!&gt;</span> <span style="color: #949494; font-style: italic;">&lt;num:.3!&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">1</span>991.  <span style="text-decoration: underline;">1</span>628.750  <span style="text-decoration: underline;">1</span>678.100  <span style="text-decoration: underline;">1</span>772.800  <span style="text-decoration: underline;">2</span>443.600</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>613.630  <span style="text-decoration: underline;">1</span>688.500  <span style="text-decoration: underline;">1</span>750.500  <span style="text-decoration: underline;">2</span>460.200</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>606.510  <span style="text-decoration: underline;">1</span>678.600  <span style="text-decoration: underline;">1</span>718.000  <span style="text-decoration: underline;">2</span>448.200</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>621.040  <span style="text-decoration: underline;">1</span>684.100  <span style="text-decoration: underline;">1</span>708.100  <span style="text-decoration: underline;">2</span>470.400</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>618.160  <span style="text-decoration: underline;">1</span>686.600  <span style="text-decoration: underline;">1</span>723.100  <span style="text-decoration: underline;">2</span>484.700</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>610.610  <span style="text-decoration: underline;">1</span>671.600  <span style="text-decoration: underline;">1</span>714.300  <span style="text-decoration: underline;">2</span>466.800</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>630.750  <span style="text-decoration: underline;">1</span>682.900  <span style="text-decoration: underline;">1</span>734.500  <span style="text-decoration: underline;">2</span>487.900</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>640.170  <span style="text-decoration: underline;">1</span>703.600  <span style="text-decoration: underline;">1</span>757.400  <span style="text-decoration: underline;">2</span>508.400</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>635.470  <span style="text-decoration: underline;">1</span>697.500  <span style="text-decoration: underline;">1</span>754.000  <span style="text-decoration: underline;">2</span>510.500</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">1</span>992.  <span style="text-decoration: underline;">1</span>645.890  <span style="text-decoration: underline;">1</span>716.300  <span style="text-decoration: underline;">1</span>754.300  <span style="text-decoration: underline;">2</span>497.400</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,850 more rows</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="computing-on-num">Computing on <code>num</code><a class="anchor" aria-label="anchor" href="#computing-on-num"></a>
</h2>
<p>Formatting numbers is useful for presentation of results. If defined
early on in the analysis, the formatting options survive most
operations. It is worth defining output options that suit your data once
early on in the process, to benefit from the formatting throughout the
analysis. We are working on seamlessly applying this formatting to the
final presentation (plots, tables, …).</p>
<div class="section level3">
<h3 id="arithmetics">Arithmetics<a class="anchor" aria-label="anchor" href="#arithmetics"></a>
</h3>
<p>When applying arithmetic operations on numbers created by
<code><a href="../reference/num.html">num()</a></code>, the result inherits the formatting of the first
<code>num</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="co">#&gt; &lt;pillar_num[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fl">1L</span> <span class="op">+</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">3.23456</span>, sigfig <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num:4[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 1.235</span></span>
<span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">4</span>, sigfig <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">3</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num:2[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">3</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">4</span>, sigfig <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num:.2![1]&gt;</span></span>
<span><span class="co">#&gt; [1] 12.00</span></span>
<span><span class="op">-</span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num[1]&gt;</span></span>
<span><span class="co">#&gt; [1] -2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mathematics">Mathematics<a class="anchor" aria-label="anchor" href="#mathematics"></a>
</h3>
<p>Similarly, for mathematical operations, the formatting is
inherited.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, label <span class="op">=</span> <span class="st">"$"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num{$}[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, notation <span class="op">=</span> <span class="st">"eng"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2e0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, label <span class="op">=</span> <span class="st">"%"</span>, scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num{%}*100[3]&gt;</span></span>
<span><span class="co">#&gt; [1] 84.1 90.9 14.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="override">Override<a class="anchor" aria-label="anchor" href="#override"></a>
</h3>
<p>In some cases, the ideal formatting changes after a transformation.
<code><a href="../reference/num.html">num()</a></code> can be applied repeatedly, the last setting wins.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">0.125</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num:.4![3]&gt;</span></span>
<span><span class="co">#&gt; [1] 1.1250 2.1250 3.1250</span></span>
<span><span class="va">transf</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">0.125</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">transf</span></span>
<span><span class="co">#&gt; &lt;pillar_num:.4![3]&gt;</span></span>
<span><span class="co">#&gt; [1]   13.3352  133.3521 1333.5214</span></span>
<span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="va">transf</span>, sigfig <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num:3[3]&gt;</span></span>
<span><span class="co">#&gt; [1]   13.3  133.  1334.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recovery">Recovery<a class="anchor" aria-label="anchor" href="#recovery"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var()</a></code> function is one of the examples where the
formatting is lost:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, notation <span class="op">=</span> <span class="st">"eng"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.333333</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/stats/median.html" class="external-link">median()</a></code> function is worse, it breaks for
<code><a href="../reference/num.html">num()</a></code> objects:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `median()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> `median.pillar_num()` not implemented.</span></span></code></pre></div>
<p>One way to recover is to apply <code><a href="../reference/num.html">num()</a></code> to the result:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, notation <span class="op">=</span> <span class="st">"eng"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2.33e0</span></span>
<span><span class="fu"><a href="../reference/num.html">num</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, notation <span class="op">=</span> <span class="st">"eng"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2e0</span></span></code></pre></div>
<p>For automatic recovery, we can also define our version of
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var()</a></code>, or even overwrite the base implementation. Note that
this pattern is still experimental and may be subject to change:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_proxy.html" class="external-link">vec_proxy</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_proxy.html" class="external-link">vec_restore</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">var_</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2.33e0</span></span></code></pre></div>
<p>This pattern can be applied to all functions that lose the
formatting. The <code>make_restore()</code> function defined below is a
function factory that consumes a function and returns a derived
function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">make_restore</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fun</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="va">fun</span><span class="op">)</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">fun</span><span class="op">(</span><span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_proxy.html" class="external-link">vec_proxy</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="fu">vctrs</span><span class="fu">::</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/vec_proxy.html" class="external-link">vec_restore</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">var_</span> <span class="op">&lt;-</span> <span class="fu">make_restore</span><span class="op">(</span><span class="va">var</span><span class="op">)</span></span>
<span><span class="va">sd_</span> <span class="op">&lt;-</span> <span class="fu">make_restore</span><span class="op">(</span><span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">var_</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 2.33e0</span></span>
<span><span class="fu">sd_</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;pillar_num(eng)[1]&gt;</span></span>
<span><span class="co">#&gt; [1] 1.53e0</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

  </div></footer>
</body>
</html>
