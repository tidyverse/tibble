<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invariants: Comparing behavior with data frames • tibble</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../tidyverse-2.css" rel="stylesheet">
<!--optional theme--><link href="../.css" rel="stylesheet">
<!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Invariants: Comparing behavior with data frames">
<meta property="og:description" content="tibble">
<meta property="og:image" content="https://tibble.tidyverse.org/logo.svg">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">tibble</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org" class="external-link">tidyverse</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">3.1.6.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/tibble.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/types.html">Data types</a>
    </li>
    <li>
      <a href="../articles/invariants.html">Comparing behavior with data frames</a>
    </li>
    <li>
      <a href="../articles/numbers.html">Controlling display of numbers</a>
    </li>
    <li>
      <a href="../articles/digits.html">Comparing display with data frames</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/04/tibble-3-0-0/" class="external-link">Version 3.0.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/03/tibble-2.1.1/" class="external-link">Version 2.1.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/01/tibble-2.0.1/" class="external-link">Version 2.0.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/11/tibble-2.0.0-pre-announce/" class="external-link">Version 2.0.0 pre-announcement</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/01/tibble-1-4-2/" class="external-link">Version 1.4.2</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/01/tibble-1-4-1/" class="external-link">Version 1.4.1</a>
    </li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
        <li>
  <a href="https://github.com/tidyverse/tibble" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Invariants: Comparing behavior with data frames</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/tibble/blob/HEAD/vignettes/invariants.Rmd" class="external-link"><code>vignettes/invariants.Rmd</code></a></small>
      <div class="hidden name"><code>invariants.Rmd</code></div>

    </div>

    
    
<style type="text/css">
.dftbl {
    width: 100%;
    table-layout: fixed;
    display: inline-table;
}

.error pre code {
    color: red;
}

.warning pre code {
    color: violet;
}
</style>
<p>This vignette defines invariants for subsetting and subset-assignment for tibbles, and illustrates where their behaviour differs from data frames. The goal is to define a small set of invariants that consistently define how behaviors interact. Some behaviors are defined using functions of the vctrs package, e.g. <code><a href="https://vctrs.r-lib.org/reference/vec_slice.html" class="external-link">vec_slice()</a></code>, <code><a href="https://vctrs.r-lib.org/reference/vec_recycle.html" class="external-link">vec_recycle()</a></code> and <code><a href="https://vctrs.r-lib.org/reference/vec_as_index.html" class="external-link">vec_as_index()</a></code>. Refer to their documentation for more details about the invariants that they follow.</p>
<p>The subsetting and subassignment operators for data frames and tibbles are particularly tricky, because they support both row and column indexes, both of which are optionally missing. We resolve this by first defining column access with <code>[[</code> and <code>$</code>, then column-wise subsetting with <code>[</code>, then row-wise subsetting, then the composition of both.</p>
<div class="section level2">
<h2 id="conventions">Conventions<a class="anchor" aria-label="anchor" href="#conventions"></a>
</h2>
<p>In this article, all behaviors are demonstrated using one example data frame and its tibble equivalent:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vctrs.r-lib.org/" class="external-link">vctrs</a></span><span class="op">)</span>
<span class="va">new_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="cn">NA</span>, <span class="fl">3L</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
  <span class="va">df</span><span class="op">$</span><span class="va">c</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>
  <span class="va">df</span><span class="op">$</span><span class="va">li</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">11</span>, <span class="fl">12</span><span class="op">:</span><span class="fl">14</span>, <span class="st">"text"</span><span class="op">)</span>
  <span class="va">df</span>
<span class="op">}</span>
<span class="va">new_tbl</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu">new_df</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Results of the same code for data frames and tibbles are presented side by side:</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">new_df</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li
<span style="color: #949494;">#&gt;</span> 1  1 e          9
<span style="color: #949494;">#&gt;</span> 2 NA f     10, 11
<span style="color: #949494;">#&gt;</span> 3  3 g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 NA h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">new_tbl</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>If the results are identical (after converting to a data frame if necessary), only the tibble result is shown.</p>
<p>Subsetting operations are read-only. The same objects are reused in all examples:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">new_df</span><span class="op">(</span><span class="op">)</span>
<span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu">new_tbl</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Where needed, we also show examples with hierarchical columns containing a data frame or a matrix:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_tbl2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/tibble.html">tibble</a></span><span class="op">(</span>
    tb <span class="op">=</span> <span class="va">tbl</span>,
    m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="va">new_df2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">new_tbl2</span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"data.frame"</span>
  <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">tb</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"data.frame"</span>
  <span class="va">df2</span>
<span class="op">}</span>
<span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">new_df2</span><span class="op">(</span><span class="op">)</span>
<span class="va">tbl2</span> <span class="op">&lt;-</span> <span class="fu">new_tbl2</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">new_tbl</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>For subset assignment (subassignment, for short), we need a fresh copy of the data for each test. The <code>with_*()</code> functions (omitted here for brevity) allow for a more concise notation. These functions take an assignment expression, execute it on a fresh copy of the data, and return the data for printing. The first example prints what’s really executed, further examples omit this output.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> {
<span style="color: #949494;">#&gt;</span>   df &lt;- new_df()
<span style="color: #949494;">#&gt;</span>   df$n &lt;- rev(df$n)
<span style="color: #949494;">#&gt;</span>   df
<span style="color: #949494;">#&gt;</span> }
</code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li
<span style="color: #949494;">#&gt;</span> 1 NA e          9
<span style="color: #949494;">#&gt;</span> 2  3 f     10, 11
<span style="color: #949494;">#&gt;</span> 3 NA g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4  1 h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> {
<span style="color: #949494;">#&gt;</span>   tbl &lt;- new_tbl()
<span style="color: #949494;">#&gt;</span>   tbl$n &lt;- rev(tbl$n)
<span style="color: #949494;">#&gt;</span>   tbl
<span style="color: #949494;">#&gt;</span> }
</code></pre>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     3 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>    <span style="color: #BB0000;">NA</span> g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
</div>
<div class="section level2">
<h2 id="column-extraction">Column extraction<a class="anchor" aria-label="anchor" href="#column-extraction"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-xj">Definition of <code>x[[j]]</code><a class="anchor" aria-label="anchor" href="#definition-of-xj"></a>
</h3>
<p><code>x[[j]]</code> is equal to <code>.subset2(x, j)</code>.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/base-internal.html" class="external-link">.subset2</a></span><span class="op">(</span><span class="va">tbl</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>NB: <code>x[[j]]</code> always returns an object of size <code>nrow(x)</code> if the column exists.</p>
<p><code>j</code> must be a single number or a string, as enforced by <code>.subset2(x, j)</code>.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1] NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning: The `j` argument of `[[.tbl_df`
#&gt; can't be a vector of length 2 as of
#&gt; tibble 3.0.0.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Recursive subsetting is deprecated for
#&gt; tibbles.
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1] NA
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in .subset2(x, i, exact = exact):
#&gt; subscript out of bounds
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `c("n", "c")` has size 2 but
#&gt; must be size 1.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `TRUE` has the wrong type
#&gt; `logical`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> It must be numeric or character.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="va">mean</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in .subset2(x, i, exact = exact):
#&gt; invalid subscript type 'closure'
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="va">mean</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `mean` has the wrong type
#&gt; `function`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> It must be numeric or character.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p><code>NA</code> indexes, numeric out-of-bounds (OOB) values, and non-integers throw an error:</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="cn">NA</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="cn">NA</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `NA` can't be `NA`.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="cn">NA_character_</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="cn">NA_character_</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `NA_character_` can't be
#&gt; `NA`.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="cn">NA_integer_</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="cn">NA_integer_</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `NA_integer_` can't be `NA`.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in .subset2(x, i, exact = exact):
#&gt; invalid negative subscript in get1index
#&gt; &lt;real&gt;
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `-1` has value -1 but must
#&gt; be a positive location.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in .subset2(x, i, exact = exact):
#&gt; subscript out of bounds
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't subset columns that don't
#&gt; exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Location 4 doesn't exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> There are only 3 columns.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">1.5</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="fl">1.5</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert from &lt;double&gt; to
#&gt; &lt;integer&gt; due to loss of precision.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="cn">Inf</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="cn">Inf</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must extract column with a single
#&gt; valid subscript.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert from &lt;double&gt; to
#&gt; &lt;integer&gt; due to loss of precision.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>Character OOB access is silent because a common package idiom is to check for the absence of a column with <code>is.null(df[[var]])</code>.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
</tr></tbody></table>
</div>
<div class="section level3">
<h3 id="definition-of-xname">Definition of <code>x$name</code><a class="anchor" aria-label="anchor" href="#definition-of-xname"></a>
</h3>
<p><code>x$name</code> and <code>x$"name"</code> are equal to <code>x[["name"]]</code>.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">$</span><span class="va">n</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">$</span><span class="st">"n"</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[[</span><span class="st">"n"</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>Unlike data frames, tibbles do not partially match names. Because <code>df$x</code> is rarely used in packages, it can raise a warning:</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">l</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [[1]]
<span style="color: #949494;">#&gt;</span> [1] 9
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[2]]
<span style="color: #949494;">#&gt;</span> [1] 10 11
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[3]]
<span style="color: #949494;">#&gt;</span> [1] 12 13 14
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[4]]
<span style="color: #949494;">#&gt;</span> [1] "text"
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">$</span><span class="va">l</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning: Unknown or uninitialised
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> column: `l`.
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">not_present</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">$</span><span class="va">not_present</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning: Unknown or uninitialised
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> column: `not_present`.
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> NULL
</code></pre>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="section level2">
<h2 id="column-subsetting">Column subsetting<a class="anchor" aria-label="anchor" href="#column-subsetting"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-xj-1">Definition of <code>x[j]</code><a class="anchor" aria-label="anchor" href="#definition-of-xj-1"></a>
</h3>
<p><code>j</code> is converted to an integer vector by <code>vec_as_index(j, ncol(x), names = names(x))</code>. Then <code>x[c(j_1, j_2, ..., j_n)]</code> is equivalent to <code>tibble(x[[j_1]], x[[j_2]], ..., x[[j_3]])</code>, keeping the corresponding column names. This implies that <code>j</code> must be a numeric or character vector, or a logical vector with length 1 or <code>ncol(x)</code>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>When subsetting repeated indexes, the resulting column names are undefined, do not rely on them.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n n.1
<span style="color: #949494;">#&gt;</span> 1  1   1
<span style="color: #949494;">#&gt;</span> 2 NA  NA
<span style="color: #949494;">#&gt;</span> 3  3   3
<span style="color: #949494;">#&gt;</span> 4 NA  NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>     <span style="font-weight: bold;">n</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>For tibbles with repeated column names, subsetting by name uses the first matching column.</p>
<p><code>nrow(df[j])</code> equals <code>nrow(df)</code>.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 0</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>Tibbles support indexing by a logical matrix, but only if all values in the returned vector are compatible.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [[1]]
<span style="color: #949494;">#&gt;</span> [1] NA
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[2]]
<span style="color: #949494;">#&gt;</span> [1] NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1] NA NA
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [[1]]
<span style="color: #949494;">#&gt;</span> [1] 1
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[2]]
<span style="color: #949494;">#&gt;</span> [1] 3
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[3]]
<span style="color: #949494;">#&gt;</span> [1] "e"
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[4]]
<span style="color: #949494;">#&gt;</span> [1] "f"
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[5]]
<span style="color: #949494;">#&gt;</span> [1] "g"
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[6]]
<span style="color: #949494;">#&gt;</span> [1] "h"
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[7]]
<span style="color: #949494;">#&gt;</span> [1] 9
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[8]]
<span style="color: #949494;">#&gt;</span> [1] 10 11
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[9]]
<span style="color: #949494;">#&gt;</span> [1] 12 13 14
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> [[10]]
<span style="color: #949494;">#&gt;</span> [1] "text"
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't combine `n` &lt;integer&gt; and
#&gt; `c` &lt;character&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="definition-of-x-j">Definition of <code>x[, j]</code><a class="anchor" aria-label="anchor" href="#definition-of-x-j"></a>
</h3>
<p><code>x[, j]</code> is equal to <code>x[j]</code>. Tibbles do not perform column extraction if <code>x[j]</code> would yield a single column.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 1</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g    
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h
</code></pre>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="definition-of-x-j-drop-true">Definition of <code>x[, j, drop = TRUE]</code><a class="anchor" aria-label="anchor" href="#definition-of-x-j-drop-true"></a>
</h3>
<p>For backward compatiblity, <code>x[, j, drop = TRUE]</code> performs column <strong>extraction</strong>, returning <code>x[j][[1]]</code> when <code>ncol(x[j])</code> is 1.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span>, <span class="fl">1</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1]  1 NA  3 NA
</code></pre>
</div>
</td>
</tr></tbody></table>
</div>
</div>
<div class="section level2">
<h2 id="row-subsetting">Row subsetting<a class="anchor" aria-label="anchor" href="#row-subsetting"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-xi">Definition of <code>x[i, ]</code><a class="anchor" aria-label="anchor" href="#definition-of-xi"></a>
</h3>
<p><code>x[i, ]</code> is equal to <code>tibble(vec_slice(x[[1]], i), vec_slice(x[[2]], i), ...)</code>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>This means that <code>i</code> must be a numeric vector, or a logical vector of length <code>nrow(x)</code> or 1. For compatibility, <code>i</code> can also be a character vector containing positive numbers.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="va">mean</span>, <span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in xj[i]: invalid subscript type
#&gt; 'closure'
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="va">mean</span>, <span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must subset rows with a valid
#&gt; subscript vector.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `mean` has the wrong type
#&gt; `function`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> It must be logical, numeric, or
#&gt; character.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in xj[i]: invalid subscript type
#&gt; 'list'
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must subset rows with a valid
#&gt; subscript vector.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `list(1)` has the wrong type
#&gt; `list`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> It must be logical, numeric, or
#&gt; character.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="st">"1"</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>Exception: OOB values generate warnings instead of errors:</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">10</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>     n    c   li
<span style="color: #949494;">#&gt;</span> NA NA &lt;NA&gt; NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fl">10</span>, <span class="op">]</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning: The `i` argument of `[.tbl_df`
#&gt; must lie in [0, rows] if positive, as of
#&gt; tibble 3.0.0.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Use `NA_integer_` as row index to obtain
#&gt; a row full of `NA` values.
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="st">"x"</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>     n    c   li
<span style="color: #949494;">#&gt;</span> NA NA &lt;NA&gt; NULL
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="st">"x"</span>, <span class="op">]</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning: The `i` argument of `[.tbl_df`
#&gt; must use valid row names as of tibble
#&gt; 3.0.0.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Use `NA_integer_` as row index to obtain
#&gt; a row full of `NA` values.
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>Unlike data frames, only logical vectors of length 1 are recycled. <!-- TODO: should this be an error? #648 --></p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 1 e          9
<span style="color: #949494;">#&gt;</span> 3 3 g 12, 13, 14
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Must subset rows with a valid
#&gt; subscript vector.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Logical subscripts must match the size
#&gt; of the indexed input.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Input has size 4 but subscript
#&gt; `c(TRUE, FALSE)` has size 2.
</span></code></pre>
</div>
</div>
</td>
</tr></tbody></table>
<p>NB: scalar logicals are recycled, but scalar numerics are not. That makes the <code>x[NA, ]</code> and <code>x[NA_integer_, ]</code> return different results.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="cn">NA</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="cn">NA_integer_</span>, <span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>    
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="definition-of-xi-drop-true">Definition of <code>x[i, , drop = TRUE]</code><a class="anchor" aria-label="anchor" href="#definition-of-xi-drop-true"></a>
</h3>
<p><code>drop = TRUE</code> has no effect when not selecting a single row:</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[</span><span class="fl">1</span>, , drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> $n
<span style="color: #949494;">#&gt;</span> [1] 1
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> $c
<span style="color: #949494;">#&gt;</span> [1] "e"
<span style="color: #949494;">#&gt;</span> 
<span style="color: #949494;">#&gt;</span> $li
<span style="color: #949494;">#&gt;</span> $li[[1]]
<span style="color: #949494;">#&gt;</span> [1] 9
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, , drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<!-- TODO: soft-deprecate -->
</div>
</div>
<div class="section level2">
<h2 id="row-and-column-subsetting">Row and column subsetting<a class="anchor" aria-label="anchor" href="#row-and-column-subsetting"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-x-and-x">Definition of <code>x[]</code> and <code>x[,]</code><a class="anchor" aria-label="anchor" href="#definition-of-x-and-x"></a>
</h3>
<p><code>x[]</code> and <code>x[,]</code> are equivalent to <code>x</code>.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
</div>
<div class="section level3">
<h3 id="definition-of-xi-j">Definition of <code>x[i, j]</code><a class="anchor" aria-label="anchor" href="#definition-of-xi-j"></a>
</h3>
<p><code>x[i, j]</code> is equal to <code>x[i, ][j]</code>.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</div>
<div class="section level3">
<h3 id="definition-of-xi-j-1">Definition of <code>x[[i, j]]</code><a class="anchor" aria-label="anchor" href="#definition-of-xi-j-1"></a>
</h3>
<p><code>i</code> must be a numeric vector of length 1. <code>x[[i, j]]</code> is equal to <code>x[i, ][[j]]</code>, or <code>vctrs::vec_slice(x[[j]], i)</code>.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1] 1
</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">[[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> [1] 9
</code></pre>
</div>
<p>This implies that <code>j</code> must be a numeric or character vector of length 1.</p>
<p>NB: <code>vec_size(x[[i, j]])</code> always equals 1. Unlike <code>x[i, ]</code>, <code>x[[i, ]]</code> is not valid.</p>
</div>
</div>
<div class="section level2">
<h2 id="column-update">Column update<a class="anchor" aria-label="anchor" href="#column-update"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-xj---a">Definition of <code>x[[j]] &lt;- a</code><a class="anchor" aria-label="anchor" href="#definition-of-xj---a"></a>
</h3>
<p>If <code>a</code> is a vector then <code>x[[j]] &lt;- a</code> replaces the <code>j</code>th column with value <code>a</code>.</p>
<p><code>a</code> is recycled to the same size as <code>x</code> so must have size <code>nrow(x)</code> or 1. (The only exception is when <code>a</code> is <code>NULL</code>, as described below.) Recycling also works for list, data frame, and matrix columns.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="st">"li"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df2</span><span class="op">(</span><span class="va">df2</span><span class="op">[[</span><span class="st">"tb"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[[&lt;-.data.frame`(`*tmp*`,
#&gt; "tb", value = structure(list(n = 1L, :
#&gt; replacement has 1 row, data has 4
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl2</span><span class="op">(</span><span class="va">tbl2</span><span class="op">[[</span><span class="st">"tb"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>    <span style="font-weight: bold;">tb$n</span> <span style="font-weight: bold;">$c</span>    <span style="font-weight: bold;">$li</span>      <span style="font-weight: bold;">m[,1]</span>  <span style="font-weight: bold;">[,2]</span>  <span style="font-weight: bold;">[,3]</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     1     0     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     0     1     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     0     0     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     0     0     0
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df2</span><span class="op">(</span><span class="va">df2</span><span class="op">[[</span><span class="st">"m"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[[</span><span class="st">"m"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[[&lt;-.data.frame`(`*tmp*`, "m",
#&gt; value = structure(c(1, 0, 0, :
#&gt; replacement has 1 row, data has 4
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl2</span><span class="op">(</span><span class="va">tbl2</span><span class="op">[[</span><span class="st">"m"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl2</span><span class="op">[[</span><span class="st">"m"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>    <span style="font-weight: bold;">tb$n</span> <span style="font-weight: bold;">$c</span>    <span style="font-weight: bold;">$li</span>      <span style="font-weight: bold;">m[,1]</span>  <span style="font-weight: bold;">[,2]</span>  <span style="font-weight: bold;">[,3]</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     1     0     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2</span>…     1     0     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3</span>…     1     0     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1</span>…     1     0     0
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p><code>j</code> must be a scalar numeric or a string, and cannot be <code>NA</code>. If <code>j</code> is OOB, a new column is added on the right hand side, with name repair if needed.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>     0
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li V4
<span style="color: #949494;">#&gt;</span> 1  1 e          9  0
<span style="color: #949494;">#&gt;</span> 2 NA f     10, 11  0
<span style="color: #949494;">#&gt;</span> 3  3 g 12, 13, 14  0
<span style="color: #949494;">#&gt;</span> 4 NA h       text  0
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>         <span style="font-weight: bold;">...4</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>     0
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in format.data.frame(if (omit)
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> x[seq_len(n0), , drop = FALSE] else
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> x, : corrupt data frame: columns will be
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> truncated or padded with NAs
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li      V5
<span style="color: #949494;">#&gt;</span> 1  1 e          9 NULL  0
<span style="color: #949494;">#&gt;</span> 2 NA f     10, 11 &lt;NA&gt;  0
<span style="color: #949494;">#&gt;</span> 3  3 g 12, 13, 14 &lt;NA&gt;  0
<span style="color: #949494;">#&gt;</span> 4 NA h       text &lt;NA&gt;  0
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't assign to columns beyond
#&gt; the end with non-consecutive locations.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Input has size 3.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `5` contains non-consecutive
#&gt; location 5.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<!-- HW: should we permitted oob assignment with numeric j? It's a bit weird to create a column with unknonw column --><p><code>df[[j]] &lt;- a</code> replaces the complete column so can change the type.</p>
<p><code>[[&lt;-</code> supports removing a column by assigning <code>NULL</code> to it.</p>
<p>Removing a nonexistent column is a no-op.</p>
</div>
<div class="section level3">
<h3 id="definition-of-xname---a">Definition of <code>x$name &lt;- a</code><a class="anchor" aria-label="anchor" href="#definition-of-xname---a"></a>
</h3>
<p><code>x$name &lt;- a</code> and <code>x$"name" &lt;- a</code> are equivalent to <code>x[["name"]] &lt;- a</code>.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     0 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     0 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     0 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="st">"n"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     0 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     0 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     0 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p><code>$&lt;-</code> does not perform partial matching.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">l</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>     0
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[[</span><span class="st">"l"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">l</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>     0
</code></pre>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="section level2">
<h2 id="column-subassignment-xj---a">Column subassignment: <code>x[j] &lt;- a</code><a class="anchor" aria-label="anchor" href="#column-subassignment-xj---a"></a>
</h2>
<ul>
<li>If <code>j</code> is missing, it’s replaced with <code>seq_along(x)</code>
</li>
<li>If <code>j</code> is logical vector, it’s converted to numeric with <code>seq_along(x)[j]</code>.</li>
</ul>
<div class="section level3">
<h3 id="a-is-a-list-or-data-frame">
<code>a</code> is a list or data frame<a class="anchor" aria-label="anchor" href="#a-is-a-list-or-data-frame"></a>
</h3>
<p>If <code>inherits(a, "list")</code> or <code>inherits(a, "data.frame")</code> is <code>TRUE</code>, then <code>x[j] &lt;- a</code> is equivalent to <code>x[[j[[1]]] &lt;- a[[1]]</code>, <code>x[[j[[2]]]] &lt;- a[[2]]</code>, …</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>   <span style="font-weight: bold;">n</span>         <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span> x         4 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span> x         3 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span> x         2 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span> x         1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"li"</span>, <span class="st">"x"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">li</span>        <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 x         4
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> x         3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 x         2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> x         1
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>If <code>length(a)</code> equals 1, then it is recycled to the same length as <code>j</code>.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>     <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     1 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1     1 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1     1 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1     1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1:2, value = list(0, 0, 0)): provided 3
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> variables to replace 2 variables
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 0 0          9
<span style="color: #949494;">#&gt;</span> 2 0 0     10, 11
<span style="color: #949494;">#&gt;</span> 3 0 0 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 0 0       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't recycle `list(0, 0, 0)`
#&gt; (size 3) to size 2.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c li
<span style="color: #949494;">#&gt;</span> 1 0 0  0
<span style="color: #949494;">#&gt;</span> 2 0 0  0
<span style="color: #949494;">#&gt;</span> 3 0 0  0
<span style="color: #949494;">#&gt;</span> 4 0 0  0
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't recycle `list(0, 0)` (size
#&gt; 2) to size 3.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>An attempt to update the same column twice gives an error.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[&lt;-.data.frame`(`*tmp*`, c(1,
#&gt; 1), value = list(1, 2)): duplicate
#&gt; subscripts for columns
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Column index 1 is used more than
#&gt; once for assignment.
</span></code></pre>
</div>
</div>
</td>
</tr></tbody></table>
<p>If <code>a</code> contains <code>NULL</code> values, the corresponding columns are removed <em>after</em> updating (i.e. position indexes refer to columns before any modifications).</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     3 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     2 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p><code>NA</code> indexes are not supported.</p>
<p>Just like column updates, <code>[&lt;-</code> supports changing the type of an existing column.</p>
<p>Appending columns at the end (without gaps) is supported. The name of new columns is determined by the LHS, the RHS, or by name repair (in that order of precedence).</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tibble.html">tibble</a></span><span class="op">(</span><span class="st">"x"</span>, x <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 5</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>        <span style="font-weight: bold;">x</span>         <span style="font-weight: bold;">y</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span> x         4
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span> x         3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span> x         2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span> x         1
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"x"</span>, x <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>        <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     x         4
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     x         3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     x         2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     x         1
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li V4
<span style="color: #949494;">#&gt;</span> 1  1 e          9  4
<span style="color: #949494;">#&gt;</span> 2 NA f     10, 11  3
<span style="color: #949494;">#&gt;</span> 3  3 g 12, 13, 14  2
<span style="color: #949494;">#&gt;</span> 4 NA h       text  1
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>         <span style="font-weight: bold;">...4</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>     4
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>     1
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[&lt;-.data.frame`(`*tmp*`, 5,
#&gt; value = list(4:1)): new columns would
#&gt; leave holes after existing columns
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't assign to columns beyond
#&gt; the end with non-consecutive locations.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Input has size 3.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `5` contains non-consecutive
#&gt; location 5.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>Tibbles support indexing by a logical matrix, but only for a scalar RHS, and if all columns updated are compatible with the value assigned.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 1 e          9
<span style="color: #949494;">#&gt;</span> 2 4 f     10, 11
<span style="color: #949494;">#&gt;</span> 3 3 g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 4 h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     4 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 1 e          9
<span style="color: #949494;">#&gt;</span> 2 1 f     10, 11
<span style="color: #949494;">#&gt;</span> 3 3 g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 2 h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Subscript `is.na(tbl)` is a
#&gt; matrix, the data `1:2` must have size 1.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 4 4          9
<span style="color: #949494;">#&gt;</span> 2 4 f     10, 11
<span style="color: #949494;">#&gt;</span> 3 4 g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 4 h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `4` must be
#&gt; compatible with existing data.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Error occurred for column `c`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert &lt;double&gt; to &lt;character&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="a-is-a-matrix-or-array">
<code>a</code> is a matrix or array<a class="anchor" aria-label="anchor" href="#a-is-a-matrix-or-array"></a>
</h3>
<p>If <code>is.matrix(a)</code>, then <code>a</code> is coerced to a data frame with <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> before assigning. If rows are assigned, the matrix type must be compatible with all columns. If <code>is.array(a)</code> and <code>any(dim(a)[-1:-2] != 1)</code>, an error is thrown.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>     <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     8     4 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     7     3 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     6     2 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     5     1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li
<span style="color: #949494;">#&gt;</span> 1  6 3          9
<span style="color: #949494;">#&gt;</span> 2  5 2     10, 11
<span style="color: #949494;">#&gt;</span> 3  4 1 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 NA h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `matrix(6:1, ncol =
#&gt; 2)` must be compatible with existing
#&gt; data.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Error occurred for column `c`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert &lt;integer&gt; to
#&gt; &lt;character&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>     <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     4     4 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     3     3 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     2     2 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1     1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>     <span style="font-weight: bold;">c</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     8     4 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     7     3 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     6     2 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     5     1 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 8 4          9
<span style="color: #949494;">#&gt;</span> 2 7 3     10, 11
<span style="color: #949494;">#&gt;</span> 3 6 2 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 5 1       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `array(8:1, dim = c(2, 1, 4))`
#&gt; must be a vector, a bare list, a data
#&gt; frame, a matrix, or NULL.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c         li
<span style="color: #949494;">#&gt;</span> 1 8 4          9
<span style="color: #949494;">#&gt;</span> 2 7 3     10, 11
<span style="color: #949494;">#&gt;</span> 3 6 2 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 5 1       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `array(8:1, dim = c(4, 1, 2))`
#&gt; must be a vector, a bare list, a data
#&gt; frame, a matrix, or NULL.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="a-is-another-type-of-vector">
<code>a</code> is another type of vector<a class="anchor" aria-label="anchor" href="#a-is-another-type-of-vector"></a>
</h3>
<p>If <code>vec_is(a)</code>, then <code>x[j] &lt;- a</code> is equivalent to <code>x[j] &lt;- list(a)</code>. This is primarily provided for backward compatbility.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     0 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     0 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     0 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     0 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     0 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     0 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     0 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>Matrices must be wrapped in <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> before assignment to create a matrix column.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>   <span style="font-weight: bold;">n[,1]</span>  <span style="font-weight: bold;">[,2]</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     5 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     2     6 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3     7 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4     8 h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>   <span style="font-weight: bold;">n[,1]</span>  <span style="font-weight: bold;">[,2]</span> <span style="font-weight: bold;">c[,1]</span>  <span style="font-weight: bold;">[,2]</span> <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     5     1     5 <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     2     6     2     6 <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3     7     3     7 <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>     4     8     4     8 <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="a-is-null">
<code>a</code> is <code>NULL</code><a class="anchor" aria-label="anchor" href="#a-is-null"></a>
</h3>
<p>Entire columns can be removed. Specifying <code>i</code> is an error.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>   <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span> e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span> g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 1</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in x[[jj]][iseq] &lt;- vjj:
#&gt; replacement has length zero
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `NULL` must be a vector, a bare
#&gt; list, a data frame or a matrix.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="section level3">
<h3 id="a-is-not-a-vector">
<code>a</code> is not a vector<a class="anchor" aria-label="anchor" href="#a-is-not-a-vector"></a>
</h3>
<p>Any other type for <code>a</code> is an error. Note that if <code>is.list(a)</code> is <code>TRUE</code>, but <code>inherits(a, "list")</code> is <code>FALSE</code>, then <code>a</code> is considered to be a scalar. See <code><a href="https://vctrs.r-lib.org/reference/vec_assert.html" class="external-link">?vec_is</a></code> and <code><a href="https://vctrs.r-lib.org/reference/vec_proxy.html" class="external-link">?vec_proxy</a></code> for details.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mean</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in rep(value, length.out = n):
#&gt; attempt to replicate an object of type
#&gt; 'closure'
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mean</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `mean` must be a vector, a bare
#&gt; list, a data frame, a matrix, or NULL.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1, value = structure(list(coefficients
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> = c(`(Intercept)` = 37.285126167342, :
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replacement element 2 has 32 rows to
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replace 4 rows
</span></code></pre>
</div>
</div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1, value = structure(list(coefficients
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> = c(`(Intercept)` = 37.285126167342, :
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replacement element 3 has 32 rows to
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replace 4 rows
</span></code></pre>
</div>
</div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1, value = structure(list(coefficients
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> = c(`(Intercept)` = 37.285126167342, :
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replacement element 5 has 32 rows to
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replace 4 rows
</span></code></pre>
</div>
</div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1, value = structure(list(coefficients
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> = c(`(Intercept)` = 37.285126167342, :
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replacement element 7 has 5 rows to
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> replace 4 rows
</span></code></pre>
</div>
</div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[&lt;-.data.frame`(`*tmp*`, 1,
#&gt; value = structure(list(coefficients =
#&gt; c(`(Intercept)` = 37.285126167342, :
#&gt; replacement element 10 has 3 rows, need
#&gt; 4
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `lm(mpg ~ wt, data = mtcars)`
#&gt; must be a vector, a bare list, a data
#&gt; frame, a matrix, or NULL.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<!-- HW: we need better error messages for these cases -->
</div>
</div>
<div class="section level2">
<h2 id="row-subassignment-xi---list---">Row subassignment: <code>x[i, ] &lt;- list(...)</code><a class="anchor" aria-label="anchor" href="#row-subassignment-xi---list---"></a>
</h2>
<p><code>x[i, ] &lt;- a</code> is the same as <code>vec_slice(x[[j_1]], i) &lt;- a[[1]]</code>, <code>vec_slice(x[[j_2]], i) &lt;- a[[2]]</code>, … .<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>Only values of size one can be recycled.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tbl</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">tbl</span><span class="op">$</span><span class="va">li</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 f     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in `[&lt;-.data.frame`(`*tmp*`, 2:4,
#&gt; , value = structure(list(n = c(1L, :
#&gt; replacement element 1 has 2 rows, need 3
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `tbl[1:2, ]` must
#&gt; be compatible with row subscript `2:4`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ 3 rows must be assigned.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Element 1 of assigned data has 2 rows.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Only vectors of size 1 are recycled.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>For compatibility, only a warning is issued for indexing beyond the number of rows. Appending rows right at the end of the existing data is supported, without warning.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">5</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 7 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">5</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">6</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">7</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n    c         li
<span style="color: #949494;">#&gt;</span> 1  1    e          9
<span style="color: #949494;">#&gt;</span> 2 NA    f     10, 11
<span style="color: #949494;">#&gt;</span> 3  3    g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 NA    h       text
<span style="color: #949494;">#&gt;</span> 5 NA &lt;NA&gt;       NULL
<span style="color: #949494;">#&gt;</span> 6  1    e          9
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't assign to rows beyond the
#&gt; end with non-consecutive locations.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Input has size 4.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Subscript `6` contains non-consecutive
#&gt; location 6.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c li
<span style="color: #949494;">#&gt;</span> 1 1 e  9
<span style="color: #949494;">#&gt;</span> 2 1 e  9
<span style="color: #949494;">#&gt;</span> 3 1 e  9
<span style="color: #949494;">#&gt;</span> 4 1 e  9
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="op">-</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't negate rows that don't
#&gt; exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Location 5 doesn't exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> There are only 4 rows.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c li
<span style="color: #949494;">#&gt;</span> 1 1 e  9
<span style="color: #949494;">#&gt;</span> 2 1 e  9
<span style="color: #949494;">#&gt;</span> 3 1 e  9
<span style="color: #949494;">#&gt;</span> 4 1 e  9
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't negate rows that don't
#&gt; exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Locations 5, 6, and 7 don't exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> There are only 4 rows.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   n c li
<span style="color: #949494;">#&gt;</span> 1 1 e  9
<span style="color: #949494;">#&gt;</span> 2 1 e  9
<span style="color: #949494;">#&gt;</span> 3 1 e  9
<span style="color: #949494;">#&gt;</span> 4 1 e  9
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="op">-</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Can't negate rows that don't
#&gt; exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Location 6 doesn't exist.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> There are only 4 rows.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>For compatibility, <code>i</code> can also be a character vector containing positive numbers.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
</div>
<div class="section level2">
<h2 id="row-and-column-subassignment">Row and column subassignment<a class="anchor" aria-label="anchor" href="#row-and-column-subassignment"></a>
</h2>
<div class="section level3">
<h3 id="definition-of-xi-j---a">Definition of <code>x[i, j] &lt;- a</code><a class="anchor" aria-label="anchor" href="#definition-of-xi-j---a"></a>
</h3>
<p><code>x[i, j] &lt;- a</code> is equivalent to <code>x[i, ][j] &lt;- a</code>.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<p>Subassignment to <code>x[i, j]</code> is stricter for tibbles than for data frames. <code>x[i, j] &lt;- a</code> can’t change the data type of existing columns.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>      n c         li
<span style="color: #949494;">#&gt;</span> 1    1 e          9
<span style="color: #949494;">#&gt;</span> 2    e f     10, 11
<span style="color: #949494;">#&gt;</span> 3    f g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 &lt;NA&gt; h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `tbl[1:2, 2]` must
#&gt; be compatible with existing data.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Error occurred for column `n`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert &lt;character&gt; to
#&gt; &lt;integer&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 2:3, 2, value = list(9, 10:11)):
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> provided 2 variables to replace 1
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> variables
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li
<span style="color: #949494;">#&gt;</span> 1  1 e          9
<span style="color: #949494;">#&gt;</span> 2 NA 9     10, 11
<span style="color: #949494;">#&gt;</span> 3  3 9 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 NA h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `tbl[1:2, 3]` must
#&gt; be compatible with existing data.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Error occurred for column `c`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert &lt;list&gt; to &lt;character&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in `[&lt;-.data.frame`(`*tmp*`,
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 2:3, 3, value = structure(list(n =
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> c(1L, : provided 3 variables to replace
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> 1 variables
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c   li
<span style="color: #949494;">#&gt;</span> 1  1 e    9
<span style="color: #949494;">#&gt;</span> 2 NA f    1
<span style="color: #949494;">#&gt;</span> 3  3 g   NA
<span style="color: #949494;">#&gt;</span> 4 NA h text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Internal error in
#&gt; `df_cast_opts()`: Data frame must have
#&gt; names.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df2</span><span class="op">(</span><span class="va">df2</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="warning">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Warning in matrix(value, n, p): data
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> length [8] is not a sub-multiple or
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> multiple of the number of columns [3]
</span></code></pre>
</div>
</div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>   tb.n tb.c tb.li m.1 m.2 m.3 m.4
<span style="color: #949494;">#&gt;</span> 1    1    e     9   1   0   0   0
<span style="color: #949494;">#&gt;</span> 2    1    0     0   0   1   0   0
<span style="color: #949494;">#&gt;</span> 3    0    1     0   0   0   1   0
<span style="color: #949494;">#&gt;</span> 4   NA    h  text   0   0   0   1
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl2</span><span class="op">(</span><span class="va">tbl2</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: Assigned data `tbl2[1:2, 2]` must
#&gt; be compatible with existing data.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> </span><span style="color: #0000BB;">ℹ</span><span style="color: #BB0000;"> Error occurred for column `tb`.
</span><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> ✖ Can't convert &lt;double[,4]&gt; to
#&gt; &lt;tbl_df&gt;.
</span></code></pre>
</div>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl2</span><span class="op">(</span><span class="va">tbl2</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span>
<span style="color: #949494;">#&gt;</span>    <span style="font-weight: bold;">tb$n</span> <span style="font-weight: bold;">$c</span>    <span style="font-weight: bold;">$li</span>      <span style="font-weight: bold;">m[,1]</span>  <span style="font-weight: bold;">[,2]</span>  <span style="font-weight: bold;">[,3]</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1</span>…     1     0     0
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2</span>…     1     1     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3</span>…    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1</span>…     0     0     0
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>A notable exception is the population of a column full of <code>NA</code> (which is of type <code>logical</code>), or the use of <code>NA</code> on the right-hand side of the assignment.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="op">{</span><span class="va">tbl</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="cn">NA</span>; <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="op">{</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n    c   li
<span style="color: #949494;">#&gt;</span> 1  1    e    9
<span style="color: #949494;">#&gt;</span> 2 NA &lt;NA&gt;   NA
<span style="color: #949494;">#&gt;</span> 3  3 &lt;NA&gt;   NA
<span style="color: #949494;">#&gt;</span> 4 NA    h text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="op">{</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
</tbody></table>
<p>For programming, it is always safer (and faster) to use the correct type of <code>NA</code> to initialize columns.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="op">{</span><span class="va">tbl</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="cn">NA_integer_</span>; <span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     3
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     2
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
<p>For new columns, <code>x[i, j] &lt;- a</code> fills the unassigned rows with <code>NA</code>.</p>
<table class="table dftbl"><tbody>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"n"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span>    n c         li
<span style="color: #949494;">#&gt;</span> 1  1 e          9
<span style="color: #949494;">#&gt;</span> 2  1 f     10, 11
<span style="color: #949494;">#&gt;</span> 3  1 g 12, 13, 14
<span style="color: #949494;">#&gt;</span> 4 NA h       text
</code></pre>
</div>
</td>
<td>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"n"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1 f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"x"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 4</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>            <span style="font-weight: bold;">x</span>
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>     1
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>    <span style="color: #BB0000;">NA</span>
</code></pre>
</div>
</td>
</tr>
<tr style="vertical-align:top">
<td>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_df</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"n"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error in x[[jj]][iseq] &lt;- vjj:
#&gt; replacement has length zero
</span></code></pre>
</div>
</div>
</td>
<td>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"n"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="error">
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span><span style="color: #BB0000;"> Error: `NULL` must be a vector, a bare
#&gt; list, a data frame or a matrix.
</span></code></pre>
</div>
</div>
</td>
</tr>
</tbody></table>
<p>Likewise, for new rows, <code>x[i, j] &lt;- a</code> fills the unassigned columns with <code>NA</code>.</p>
<table class="table dftbl"><tbody><tr style="vertical-align:top">
<td>
</td>
<td>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">with_tbl</span><span class="op">(</span><span class="va">tbl</span><span class="op">[</span><span class="fl">5</span>, <span class="st">"n"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode">
<pre class="sourceCode"><code class="sourceCode"><span style="color: #949494;">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 3</span>
<span style="color: #949494;">#&gt;</span>       <span style="font-weight: bold;">n</span> <span style="font-weight: bold;">c</span>     <span style="font-weight: bold;">li</span>       
<span style="color: #949494;">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1 e     <span style="color: #949494;">&lt;dbl [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">2</span>    <span style="color: #BB0000;">NA</span> f     <span style="color: #949494;">&lt;int [2]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">3</span>     3 g     <span style="color: #949494;">&lt;int [3]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span> h     <span style="color: #949494;">&lt;chr [1]&gt;</span>
<span style="color: #949494;">#&gt;</span> <span style="color: #BCBCBC;">5</span>     0 <span style="color: #BB0000;">NA</span>    <span style="color: #949494;">&lt;NULL&gt;</span>
</code></pre>
</div>
</td>
</tr></tbody></table>
</div>
<div class="section level3">
<h3 id="definition-of-xi-j---a-1">Definition of <code>x[[i, j]] &lt;- a</code><a class="anchor" aria-label="anchor" href="#definition-of-xi-j---a-1"></a>
</h3>
<p><code>i</code> must be a numeric vector of length 1. <code>x[[i, j]] &lt;- a</code> is equivalent to <code>x[i, ][[j]] &lt;- a</code>.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<p>NB: <code>vec_size(a)</code> must equal 1. Unlike <code>x[i, ] &lt;-</code>, <code>x[[i, ]] &lt;-</code> is not valid.</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><code>x[j][[jj]]</code> is equal to <code>x[[ j[[jj]] ]]</code>, in particular <code>x[j][[1]]</code> is equal to <code>x[[j]]</code> for scalar numeric or integer <code>j</code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Row subsetting <code>x[i, ]</code> is not defined in terms of <code>x[[j]][i]</code> because that definition does not generalise to matrix and data frame columns. For efficiency and backward compatibility, <code>i</code> is converted to an integer vector by <code>vec_as_index(i, nrow(x))</code> first.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><code>x[,]</code> is equivalent to <code>x[]</code> because <code>x[, j]</code> is equivalent to <code>x[j]</code>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>A more efficient implementation of <code>x[i, j]</code> would forward to <code>x[j][i, ]</code>.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Cell subsetting <code>x[[i, j]]</code> is not defined in terms of <code>x[[j]][[i]]</code> because that definition does not generalise to list, matrix and data frame columns. A more efficient implementation of <code>x[[i, j]]</code> would check that <code>j</code> is a scalar and forward to <code>x[i, j][[1]]</code>.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><code>$</code> behaves almost completely symmetrically to <code>[[</code> when comparing subsetting and subassignment.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p><code>x[i, ]</code> is symmetrically for subset and subassignment.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p><code>x[i, j]</code> is symmetrically for subsetting and subassignment. A more efficient implementation of <code>x[i, j] &lt;- a</code> would forward to <code>x[j][i, ] &lt;- a</code>.<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p><code>x[[i, j]]</code> is symmetrically for subsetting and subassignment. An efficient implementation would check that <code>i</code> and <code>j</code> are scalar and forward to <code>x[i, j][[1]] &lt;- a</code>.<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="tidyverse">
  <p>tibble is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org" class="external-link">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by .
    Site built by <a href="https://pkgdown.r-lib.org" class="external-link">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '24f802ea87b9d1054ef63db70ff7c836',
    indexName: 'tibble',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
