<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extending tibble • tibble</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- tidyverse --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">tibble</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/tibble.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/extending.html">Extending tibble</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/tibble">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Extending tibble</h1>
            
          </div>

    
    
<div class="contents">
<p>To extend the tibble package for new types of columnar data, you need to understand how printing works. The presentation of a column in a tibble is powered by two S3 generics:</p>
<ul>
<li>
<code><a href="../reference/obj_sum.html">type_sum()</a></code> determines what goes into the column header.</li>
<li>
<code><a href="../reference/obj_sum.html">obj_sum()</a></code> is used when rendering list columns.</li>
</ul>
<p>If you have written an S3 or S4 class that can be used as a column, you can override these generics to make sure your data prints well in a tibble. To start, you must import the <code>tibble</code> package. Either add <code>tibble</code> to the <code>Imports:</code> section of your <code>DESCRIPTION</code>, or simply call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">use_package</span>(<span class="st">"tibble"</span>)</code></pre></div>
<p>This vignette assumes a package that implements an S3 class <code>"foo"</code> and uses <code>roxygen2</code> to create documentation and the <code>NAMESPACE</code> file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#' @export</span>
foo &lt;-<span class="st"> </span>function(x) {
  <span class="kw">stopifnot</span>(<span class="kw">is.numeric</span>(x))
  <span class="kw">structure</span>(x, <span class="dt">class =</span> <span class="st">"foo"</span>)
}</code></pre></div>
<div id="type_sum" class="section level2">
<h2 class="hasAnchor">
<a href="#type_sum" class="anchor"></a><code><a href="../reference/obj_sum.html">type_sum()</a></code>
</h2>
<p>This method should return a length-1 character vector that can be used in a column header. Strive for an evocative abbreviation that’s under 6 characters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/obj_sum.html">type_sum</a></span>(<span class="dv">1</span>)
<span class="co">#&gt; [1] "dbl"</span>
<span class="kw"><a href="../reference/obj_sum.html">type_sum</a></span>(<span class="dv">1</span>:<span class="dv">10</span>)
<span class="co">#&gt; [1] "int"</span>
<span class="kw"><a href="../reference/obj_sum.html">type_sum</a></span>(<span class="kw">Sys.time</span>())
<span class="co">#&gt; [1] "dttm"</span></code></pre></div>
<p>The default implementation works reasonably well for any kind of object, but the generated output may be too wide and waste precious space when displaying the tibble:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/obj_sum.html">type_sum</a></span>(<span class="kw">foo</span>(<span class="dv">1</span>:<span class="dv">10</span>))
<span class="co">#&gt; [1] "S3: foo"</span></code></pre></div>
<p>To avoid this for provide a method for <code><a href="../reference/obj_sum.html">type_sum()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#' @export</span>
type_sum.foo &lt;-<span class="st"> </span>function(x, ...) {
  <span class="st">"foo"</span>
}

<span class="kw"><a href="../reference/obj_sum.html">type_sum</a></span>(<span class="kw">foo</span>(<span class="dv">1</span>:<span class="dv">10</span>))
<span class="co">#&gt; [1] "foo"</span></code></pre></div>
</div>
<div id="obj_sum" class="section level2">
<h2 class="hasAnchor">
<a href="#obj_sum" class="anchor"></a><code><a href="../reference/obj_sum.html">obj_sum()</a></code>
</h2>
<p>This method is primarily used for displaying list columns. A list column is a powerful way to attach hierarchical or unstructured data to an observation in a data frame. Implementations of <code><a href="../reference/obj_sum.html">obj_sum()</a></code> are expected to return a character vector as long as the input, with brief description of the contents of each input element.</p>
<p>Examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/obj_sum.html">obj_sum</a></span>(<span class="dv">1</span>)
<span class="co">#&gt; [1] "dbl [1]"</span>
<span class="kw"><a href="../reference/obj_sum.html">obj_sum</a></span>(<span class="dv">1</span>:<span class="dv">10</span>)
<span class="co">#&gt; [1] "int [10]"</span>
<span class="kw"><a href="../reference/obj_sum.html">obj_sum</a></span>(<span class="kw">Sys.time</span>())
<span class="co">#&gt; [1] "dttm [1]"</span>
<span class="kw"><a href="../reference/obj_sum.html">obj_sum</a></span>(<span class="kw">list</span>(<span class="dv">1</span>:<span class="dv">5</span>))
<span class="co">#&gt; [1] "int [5]"</span>
<span class="kw"><a href="../reference/obj_sum.html">obj_sum</a></span>(<span class="kw">list</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>))
<span class="co">#&gt; [1] "chr [1]" "chr [1]" "chr [1]"</span></code></pre></div>
<p>The default implementation calls <code><a href="../reference/obj_sum.html">type_sum()</a></code> and appends the size of the object in brackets. If your object is built on top of an atomic vector the default will be adequate. You, will, however, need to provide a method if your object is vectorised and built on top of a list.</p>
<p>An example of an object of this type in base R <code>POSIXlt</code>: it is a list with 9 components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">Sys.time</span>() +<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">3600</span>)) 
<span class="kw">str</span>(<span class="kw">unclass</span>(x))
<span class="co">#&gt; List of 11</span>
<span class="co">#&gt;  $ sec   : num [1:3] 50 50 50</span>
<span class="co">#&gt;  $ min   : int [1:3] 41 42 41</span>
<span class="co">#&gt;  $ hour  : int [1:3] 7 7 8</span>
<span class="co">#&gt;  $ mday  : int [1:3] 14 14 14</span>
<span class="co">#&gt;  $ mon   : int [1:3] 3 3 3</span>
<span class="co">#&gt;  $ year  : int [1:3] 117 117 117</span>
<span class="co">#&gt;  $ wday  : int [1:3] 5 5 5</span>
<span class="co">#&gt;  $ yday  : int [1:3] 103 103 103</span>
<span class="co">#&gt;  $ isdst : int [1:3] 1 1 1</span>
<span class="co">#&gt;  $ zone  : chr [1:3] "CDT" "CDT" "CDT"</span>
<span class="co">#&gt;  $ gmtoff: int [1:3] -18000 -18000 -18000</span>
<span class="co">#&gt;  - attr(*, "tzone")= chr [1:3] "" "CST" "CDT"</span></code></pre></div>
<p>But it pretends to be a vector with 3 elements:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x
<span class="co">#&gt; [1] "2017-04-14 07:41:50 CDT" "2017-04-14 07:42:50 CDT"</span>
<span class="co">#&gt; [3] "2017-04-14 08:41:50 CDT"</span>
<span class="kw">length</span>(x)
<span class="co">#&gt; [1] 3</span>
<span class="kw">str</span>(x)
<span class="co">#&gt;  POSIXlt[1:3], format: "2017-04-14 07:41:50" "2017-04-14 07:42:50" ...</span></code></pre></div>
<p>So we need to define a method that returns a character vector the same length as <code>x</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#' @export</span>
obj_sum.POSIXlt &lt;-<span class="st"> </span>function(x) {
  <span class="kw">rep</span>(<span class="st">"POSIXlt"</span>, <span class="kw">length</span>(x))
}</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#type_sum"><code><a href="../reference/obj_sum.html">type_sum()</a></code></a></li>
      <li><a href="#obj_sum"><code><a href="../reference/obj_sum.html">obj_sum()</a></code></a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="tidyverse">
  <p>tibble is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by Kirill Müller, <a href="http://hadley.nz">Hadley Wickham</a>, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989-18', 'auto');
  ga('send', 'pageview');
</script></footer>
</div>

  </body>
</html>
